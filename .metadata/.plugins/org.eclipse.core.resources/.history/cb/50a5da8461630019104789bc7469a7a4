package com.shachar.first;

import java.sql.ResultSet;
import java.sql.SQLException;

public class PostDatabase extends AbstractEntityDatabase<Post> {
	@Override
	protected String getEntityTableName() {
		return "posts";
	}

	@Override
	protected String insertEntitySQL(Post entity) {
		return String.format(
				"insert into posts " + "(email, postText, replayFor, postSubTopic)" + " values('%s', '%s', '%d', '%s')",
				entity.getEmail(), entity.getPostText(), entity.getReplayTo(), entity.getPostTopicId());
	}

	@Override
	protected Post entityFromResultSet(ResultSet rs) throws SQLException {
		Post post = new Post(rs.getString("email"), rs.getString("post_text"), rs.getInt("replay_to"),rs.getInt("post_topic_id"));
		post.setId(rs.getInt("id"));
		return post;
	}

	@Override
	protected Post getDBEntity(Post entity) {
		return entity;
	}

}
