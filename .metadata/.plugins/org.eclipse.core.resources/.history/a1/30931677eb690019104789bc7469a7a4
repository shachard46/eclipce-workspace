package com.shachar.first;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;
import java.util.Map;

public class PollAnswerDatabase extends AbstractEntityDatabase<PollAnswer>{

	@Override
	protected String getEntityTableName() {
		return "poll_answers";
	}

	@Override
	protected PollAnswer getDBEntity(PollAnswer entity) {
		return entity;
	}

	@Override
	protected String insertEntitySQL(PollAnswer entity) {
		return String.format("insert into poll_answers " + "(question, answer)"
				+ " values('%s', '%s')",
		entity.getQuestion(), entity.getAnswer());
	}

	@Override
	protected PollAnswer entityFromResultSet(ResultSet rs) throws SQLException {
		return new PollAnswer(rs.getString("question"), rs.getString("answer"));
	}
	public Map<String,Integer> getAnswerCounts(String question) {
		String sql = String.format("select answer, count(*) from poll_answers group by answer where question = '%s'", question);
	}

	

}
