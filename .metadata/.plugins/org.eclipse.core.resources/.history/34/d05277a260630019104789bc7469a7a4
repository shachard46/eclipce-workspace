package com.shachar.first;

import java.sql.ResultSet;
import java.sql.SQLException;

public class PostDatabase extends AbstractEntityDatabase<Post> {
	@Override
	protected String getEntityTableName() {
		return "posts";
	}

	@Override
	protected String insertEntitySQL(Post entity) {
		return String.format(
				"insert into posts " + "(email, postText, replayFor, postSubTopic)" + " values('%s', '%s', '%d', '%s')",
				entity.getEmail(), entity.getPostText(), entity.getReplayFor(), entity.getPostSubTopic());
	}

	@Override
	protected Post entityFromResultSet(ResultSet rs) throws SQLException {
		return new Post(rs.getInt("id"), rs.getString("email"), rs.getString("postText"), rs.getInt("replayFor"),
				rs.getString("postSubTopic"));
	}

	@Override
	protected Post getDBEntity(Post entity) {
		return entity;
	}

}
