<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ page import="com.shachar.first.*"%>
<%@ page import="java.util.List"%>

<%
	if (request.getSession().getAttribute("validUser") == null) {
		request.getSession().setAttribute("validUser", "wrong");
	}
	TopicDatabase topicDatabase = new TopicDatabase();
	List<Topic> parentTopics = topicDatabase.getAllParentTopics();
%>
<html dir="rtl">
<head>
<title>FirstForum</title>
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body class="forum">
	<div class="menuBar">
		<%
			if (request.getSession().getAttribute("validUser").equals("right")) {
				out.print(
						"\r<a href='oneUser.jsp'><div class='menuBarOption user_link'></div></a><div class='menuBarOption sign_up_in'><a href='dbLogout.jsp'>התנתק</a></div>");

			}

			else {
				out.print(
						"\r<div class='menuBarOption user_link'></div><div class='menuBarOption sign_up_in'><a href='register.jsp'>הירשם</a></div>");
			}
		%>
		<div class="menuBarOption sign_up_in">
			<a href="signIn.jsp">היכנס</a>
		</div>
		<div class="menuBarOption users_option">
			<a href="quiz.jsp">חידון</a>
		</div>

		<div class="menuBarOption post_option">
			<a href="quiz.jsp">פרסם פוסט</a>
		</div>
		<div class="menuBarOption in_forum">
			<a href="forumBase.jsp">פורום</a>
		</div>
		<div class="menuBarOption users_option">
			<a href="users.jsp">משתמשים</a>
		</div>
		<div class="first-logo">
			<div class="menuBarOption">
				<a href="https://www.firstisrael.org.il/"><img
					src="img/FIRSTWordMark_Black.gif" class="first-logo-img" /></a>
			</div>
		</div>
	</div>
	<div class="big_container">
		<table class="container">
			<%
				for (Topic parentTopic : parentTopics) {
			%>
			<tr>
				<td colspan="3" class="header"><%=parentTopic.getName()%></td>
			</tr>
			<%
				List<Topic> subTopics = topicDatabase.getSubTopics(parentTopic.getId());
					for (Topic subTopic : subTopics) {
			%>
			<tr>
				<td class="sub_topic"><a href="forumThreads.jsp?topic_id=<%=subTopic.getId() %>"><%=subTopic.getName() %></a></td>
				<td class="last_post"><a href="forumPost.jsp">*last post*</a></td>
				<td class="post_amount">*posts*</td>
			</tr>
			<%
					}
			%>
			<%
				}
			%>
		</table>
	</div>
</body>
</html>
